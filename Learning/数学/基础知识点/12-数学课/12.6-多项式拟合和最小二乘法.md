---
aliases: 12.6-多项式拟合和最小二乘法
tags:
date created: Wednesday, October 9th 2024, 6:26:21 pm
date modified: Wednesday, October 9th 2024, 6:26:35 pm
---
在介绍**多项式拟合**和**最小二乘法**时，我们的目标是找到一个多项式，它能尽可能准确地逼近一组数据点。这里结合数学公式，讲解它们的概念、推导过程，以及它们的几何意义。

### 1. **问题背景**
在实际应用中，数据点通常不是完美的插值点，可能存在测量误差或噪声。插值方法（如拉格朗日插值、牛顿插值）虽然能通过所有给定的点，但有时候高次插值多项式会出现**过拟合**或**龙格现象**，即曲线在插值点之间剧烈震荡，不符合数据的整体趋势。为了解决这个问题，我们使用**多项式拟合**。

**多项式拟合**的目标是：给定一组数据点$(x_0, y_0), (x_1, y_1), \dots, (x_n, y_n)$，找到一个适当阶数的多项式$P(x)$，使得它尽可能平滑地逼近这些数据点，而不是精确通过每一个点。

最常用的方法是**最小二乘法**。

### 2. **多项式拟合**

我们要拟合的多项式形式为：

$$
P(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_m x^m
$$

这里$m$是多项式的阶数，$a_0, a_1, \dots, a_m$是我们需要确定的多项式系数。

### 3. **最小二乘法的基本思想**

最小二乘法的核心思想是：我们希望找到多项式$P(x)$，使得它在每个点$x_i$上的值$P(x_i)$与实际数据点$y_i$之间的误差尽可能小。为了衡量这个误差，我们定义每个点的**误差**为$P(x_i) - y_i$。

由于正负误差可能会相互抵消，最小二乘法通过**平方**这些误差，确保所有误差都为正，并求和：

$$
S = \sum_{i=0}^{n} (P(x_i) - y_i)^2
$$

我们的目标是通过调整多项式系数$a_0, a_1, \dots, a_m$，**最小化**这个误差平方和$S$。

### 4. **最小化误差平方和**

为了最小化这个误差平方和$S$，我们可以通过对每个系数$a_j$求偏导数，并令其为零，即：

$$
\frac{\partial S}{\partial a_j} = 0, \quad \text{for} \quad j = 0, 1, \dots, m
$$

对于每个$a_j$，这个条件会给我们一组**线性方程组**。这些方程组可以写成矩阵形式，称为**法方程**。

### 5. **矩阵形式**

我们先写出多项式$P(x)$的具体形式：

$$
P(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_m x^m
$$

对于每个数据点$x_i$，我们有：

$$
y_i \approx a_0 + a_1 x_i + a_2 x_i^2 + \dots + a_m x_i^m
$$

将这些方程整理成矩阵形式，可以表示为：

$$
\begin{bmatrix}
1 & x_0 & x_0^2 & \dots & x_0^m \\
1 & x_1 & x_1^2 & \dots & x_1^m \\
\vdots & \vdots & \vdots & & \vdots \\
1 & x_n & x_n^2 & \dots & x_n^m \\
\end{bmatrix}
\begin{bmatrix}
a_0 \\
a_1 \\
\vdots \\
a_m \\
\end{bmatrix}
=
\begin{bmatrix}
y_0 \\
y_1 \\
\vdots \\
y_n \\
\end{bmatrix}
$$

我们需要解这个方程组，以得到系数$a_0, a_1, \dots, a_m$。

### 6. **几何解释**

最小二乘法的几何解释是，我们要找到一个多项式曲线，使它尽可能贴近给定的数据点，而不是通过每个点。误差的平方和$S$就代表曲线与数据点之间的整体偏离程度。通过最小化这个偏离值，我们得到一个既能拟合数据点的趋势，又能避免过拟合的平滑曲线。

可以把拟合的多项式曲线想象成一条尽量通过数据云中心的平滑曲线。

### 7. **例子说明**

假设我们有以下数据点$(1, 1)$，$(2, 2)$，$(3, 3)$，我们想用一个二次多项式$P(x) = a_0 + a_1 x + a_2 x^2$来拟合它们。

首先列出每个点的误差方程：

$$
\begin{aligned}
P(1) & = a_0 + a_1 \cdot 1 + a_2 \cdot 1^2 = 1 \\
P(2) & = a_0 + a_1 \cdot 2 + a_2 \cdot 2^2 = 2 \\
P(3) & = a_0 + a_1 \cdot 3 + a_2 \cdot 3^2 = 3 \\
\end{aligned}
$$

这将给我们三组方程，解这些方程即可得到系数$a_0, a_1, a_2$。

通过矩阵求解后，我们得到拟合多项式：

$$
P(x) = a_0 + a_1 x + a_2 x^2
$$

### 8. **总结**
- **多项式拟合**通过一个低阶的多项式来逼近数据点的整体趋势。
- **最小二乘法**通过最小化多项式与数据点之间的平方误差和，找到一个最优的多项式。
- 这种方法适用于数据噪声较大的情况，避免高阶插值引发的过拟合问题，特别是在数据点较多时。

通过结合公式和几何解释，学生可以直观地理解多项式拟合和最小二乘法的思想，同时例子能够展示这些方法的具体应用。