---
aliases: 1-贝叶斯定理
tags: []
date created: Invalid date
date modified: 2024, 七月 13日, 11:45:27,  星期六中午
---

> [zhuanlan.zhihu.com/p/661548936](https://zhuanlan.zhihu.com/p/661548936)

```ad-thm
- ~ 贝叶斯因子 (BF) 使用以下公式计算： **BF = P(Data∣Hypothesis1) / P(Data∣Hypothesis2**) 在这里， P(Data∣Hypothesis1) 是第一个假设下数据的概率，并且 P(Data∣Hypothesis2) 是第二个假设下数据的概率。

- ***$P(A)$ 叫做先验概率$P(A|D)$ 叫做后验概率***。**意思是有了实验数据D之后对A重新做了新的概率判断，修订了原来的先验概率。** 
- ***$P(D|A)$ 叫做似然likelyhood***：假设A为条件，D的可能性有多大？
- ***$P(D)$叫做边缘概率，也叫显著性证据***。

于是从条件概率定义有完整的贝叶斯推断公式：
$$P(A|D) =\frac{P(AD)}{P(D)}= \frac{P(D|A)P(A)}{P(D)} = \frac{P(D|A)P(A)}{P(D|A)P(A) + P(D|B)P(B) + \cdots} $$
- 先验概率乘以似然度的乘积 ***$P(D|A)P(A)$ 在贝叶斯推断中被称为先验似然度***（prior likelihood）。

实际上==后验概率就是先验似然度在总的先验似然度中的占比==。

==$\frac{P(D|A)}{P(D|¬A)}$ 叫做似然比==（likelihood ratio）。
```

# Part1 深入理解贝叶斯推理（一）
$P(A|D)/P(A)$ 被称为**贝叶斯因子（Bayes factor）我认为更应该叫支持度**，是 $A$ 的支持度。类似的 $P(B|D)/P(B)$ 是 $B$ 的支持度、$P(C|D)/P(C)$ 是 C 的支持度。
- 原题解答中的 $P(A|D) =18/83 < 先验P(A)=1/3$。这个含义是说贝叶斯推断支持**没选骰子 A**！支持的力度有多大呢？支持的力度用后验/先验这个比值来描述！即后验对先验的修订程度是大于 1 还是小于 1。
- 如果大于 1，就是支持该选项 A；如果小于 1，就是不支持该选项 A。
---
原题解答中，先验 $P(A)=P(B)=P(C)=1/3$ ，计算 $A,B,C$ 各自的后验概率：
- P(A|D) =18/(18+64+1) =18/83 < 先验 P(A)=1/3。所以有 P(A|D)/P(A) <54/83 <1 。含义是说不支持选择 A。
- P(B|D) =64/(18+64+1) =64/83 > 先验 P(B)=1/3。所以有 P(B|D)/P(B) >192/83 = 2.31 >1 。含义是说**支持选择 B**。
- P(C|D) =1/(18+64+1) =1/83 < 先验 P(C)=1/3。所以有 P(C|D)/P(C) <1/83 <1 。含义是说不支持选择 C。
- 在进一步思考中，先验 P(A)=4/6,P(B)=P(C)=1/6，计算 A,B,C 各自的后验概率：
- $P(A|D) =18*4/(18*4+64*1+1*1) =72/137 < 先验 P(A)=4/6$。所以有 P(A|D)/P(A) = 92/137 <1 。含义是说不支持选择 A。
- $P(B|D) =64*1/(18*4+64*1+1*1) =64/137 > 先验 P(B)=1/6$。所以有 P(B|D)/P(B) = 384/137=2.80 >1。含义是说**支持选择 B**。
- $P(C|D) =1*1/(18*4+64*1+1*1) =1/137 < 先验 P(C)=1/6$。所以有 P(C|D)/P(C) = 6/137 <1 。含义是说不支持选择 C。
好，**这里统一了意见：都支持 B**！这可能是正确的了？!**支持力度有多大我们还没有定量的概念，在下一节有定量说明极大值。支持度和极大值之间的距离越近，则表示支持力度越强！反之则支持力度较弱。**
# Part2 数据越多答案越明确

> **如何才能获得更加确定的推理判断呢？答案：延长序列（观测到更多数据）。**

- ~ 题解中抛掷了 7 次，结果如下：3,5,4,8,3,9,7，记录为 D。如果抛掷越来越多次，我们对当初的选择 B 的判断就越来越大，直到 $P(B|D)\rightarrow1$！
![[Pasted image 20240713020406.png]]
2 x 2 x 2 x 2 x 2 x 1 x 2=64
简化思考，假设我们得到如上的 7 次序列数据 D 有 2 个（这里不分先后，为两次独立的投掷事件），也就是说有 14 条数据，计算 B 的后验概率和支持度：
$$P(B|D) =64^2/(18^2+64^2+1^2) =4096/4421 > 先验P(B)=1/3$$
- 所以有支持度 P(B|D)/P(B) =12288/4421=2.78 >1 。比较例原题解答中 P(B|D)/P(B) =192/83 = 2.31，这里的值 12288/4421=2.78**更大了，也就是信任增强了**。（新的问题，到底多大是很大呢？最大有多大呢？下面有解答）
可想而知序列数据 D 有 n 个，n 很大的时候，计算 B 的后验概率和支持度：
- $P(B|D) =(64^n)/(18^n+64^n+1^n)$ 显然有：当 n-->∞的时候 P(B|D)-->1 (==这里我回顾了一下 [[7-极限|洛必达法则]]，但没有直观想清楚洛必达法则的 $\frac{\infty }{\infty}$ 形式为何成立==)
- B 的支持度（贝叶斯因子） P(B|D)/P(B) = P(B|D) /(1/3) 也当 n-->∞的时候 P(B|D)/P(B) -->**1/P(B)=** 3 >1
- **可知最大值是 1/P(B)=3**
- 在前面的 2 个序列数据 D 即 14 条数据的时候，支持度 P(B|D)/P(B) =12288/4421=2.78 远大于 1**已经很接近最大值 3 了，**几乎是笃定推断 B 了！！
- 具体计算是先求倒数：
- $$\lim_{n\rightarrow\infty}\frac{P(B)}{P(B|D)}= P(B)* \frac{18^n+64^n+1^n}{64^n} = \frac{1}{3}* \frac{18^n+64^n+1^n}{64^n} = \frac{1}{3}*\frac{(\frac{18}{64})^n+1+(\frac{1}{64})^n}{1}=\frac{1}{3} $$
在进一步思考中，先验 P(A)=4/6,P(B)=P(C)=1/6,计算 A，B 各自的后验概率和支持度：
- ${P(A|D)=(18^n)^{\times}4/((18^n)^{\times}4+(64^n)^{\times}1+(1^n)^{\times}1),当n->\infty}$ 的时候 $P(A|D)-->0$
	- 所以有 A 的支持度 (贝叶斯因子) P(A|D)/P(B)-->0<1
- ${P(B|D)=(64^n)^{\times}1/((18^n)^{\times}4+(64^n)^{\times}1+(1^n)^{\times}1),当n->\infty}$ 的时候 P(B|D)-->1
	- 所以有 B 的支持度 (贝叶斯因子) P(B|D)/P(B)-->1/P(B)=6>1 可知最大值是 1/P(B)=6
## 总结：
一开始观测数据很少有可能后验概率维持了先验概率，各个支持度 P(X|D)/P(X) 有可能等于 1。只要数据多了，各个支持度中 P(X|D)/P(X) 中肯定至少有一个大于 1，也肯定至少有一个小于 1。观测数据支持大于 1 的 P(X|D)/P(X) 中最大者。
当数据足够足够多的时候，大数定律发挥作用，某个 P(X|D)/P(X) 会无限接近于 1/P(X)，得到笃定支持，譬如本例中的 P(B|D)/P(B)-->**1/P(B)**。与此同时，其它的 P(X|D)/P(X) 都会无限接近于 0，支持被否定，譬如本例中的 P(A|D)/P(A) 和 P(C|D)/P(C)。
# Part3 支持的答案可能变化

> **第三：数据序列会一直支持 B 吗？不会变化吗？答案：有可能在变化！数据序列越长越接近事实真相！**

我们用例子来分析。题解中抛掷了 7 次，结果如下：3,5,4,8,3,9,7。

##### 假设一：在抛掷了第 1 次之后，数据序列里只有 1 个符号 3，我们就开始计算支持度：

- 令这 1 条数据为 D。假设从三个骰子中选取一个是均等的，即先验概率 P(A)=P(B)=P(C)=1/3。
- 根据条件概率定义有：$P(A|D)=\frac{P(D|A)P(A)}{[P(D|A)P(A) + P(D|B)P(B) + P(D|C)P(C)]}$
- P(D|A)= 3/20 = 3/20
- P(D|B) =2/20 = 2/20
- P(D|C) =1/20 = 1/20
- 所以得到了:
- P(A|D) =3/(3+2+1)=1/2, P(A|D)/P(A)=3/2 >1 推理支持 A（当只有 1 条数据的时候）
- P(B|D) =2/(3+2+1)=1/3, P(A|D)/P(A)=1
- & 我们发现有支持度为 1 的情况，但是并不一定受支持！当然还有可能出现所有支持度都为 1 的情况，表示暂时平分秋色，还无法判断！期待更多观测数据。（有个极端情况，假设 A,B,C 三个骰子上的符号完全一样，那就 A,B,C 的支持度永远都等于 1，永远是平分秋色，无法推断！）
- P(C|D) =1/(3+2+1)=1/6, P(A|D)/P(A)=1/2 <1

##### 假设二：在抛掷了第 2 次之后，数据序列里只有 2 个数 3,5（即第 2 次投出 5），我们就开始计算支持度：

- 令这 2 条数据为 D。假设从三个骰子中选取一个是均等的，即先验概率 P(A)=P(B)=P(C)=1/3。
- 根据条件概率定义有：$P(A|D)=\frac{P(D|A)P(A)}{[P(D|A)P(A) + P(D|B)P(B) + P(D|C)P(C)]}$
- $P(D|A)= 3*1/20^2 = 3/20^2$(独立抛掷 2 次是乘法事件)
- $P(D|B) =2*2/20^2 = 4/20^2$
- $P(D|C) =1/20^2 = 1/20^2$
- 所以得到了:
- P(A|D) =3/(3+4+1)=3/8, P(A|D)/P(A)=9/8 >1 我们发现有支持度大于 1 的情况，但是并不一定受支持！
- P(B|D) =4/(3+4+1)=4/8, P(A|D)/P(A)=12/8 >1 推理支持 B，因为比 A 的支持度要大（当只有 2 条数据的时候）
- P(C|D) =1/(3+4+1)=1/8, P(A|D)/P(A)=3/8 <1
## 结论
支持某一个，早期可能变化，后期也可能还变化！一般来说，当数据序列越来越长的时候，大数定律发挥作用，对某个的支持度越来越高！越来越笃定地支持某个（本例中是 B）！后面会越来越稳定

# Part4 用贝叶斯推断做预测

> 题解中抛掷了 7 次，结果如下：3,5,4,8,3,9,7，记录为 D。我们预测下一次抛掷的结果（1-20 符号的概率各自多大）？

参见《**前言：例子**》有，先验 P(A)=P(B)=P(C)=1/3 ，后验概率为：

- P(A|D) =18/(18+64+1) =18/83
- P(B|D) =64/(18+64+1) = 64/83 含义是说支持选择 B。
- P(C|D) =1/(18+64+1) =1/83

所以预测下一次掷得各个 symbol 的概率 S 分别是：

根据表格，P(S1|A)=6/20, P(S1|B)=3/20, P(S1|C)=1/20，所以有
$P(S1|D)=P(S1|A)*P(A|D) + P(S1|B)*P(B|D) + P(S1|C)*P(C|D) =301/(20*83) =301/1660$
根据表格，P(S2|A)=4/20, P(S2|B)=3/20, P(S2|C)=1/20，所以有：
$P(S2|D) = P(S2|A)*P(A|D) + P(S2|B)*P(B|D) + P(S2|C)*P(C|D) =265/(20*83)= 265/1660$

- 以此类推可以计算所有符号 (S)1-20 的概率。这里就不一一列举了。读者可以自己计算一下 P(S3|D),P(S4|D),…。
# Part5 因果推断和贝叶斯大脑

前面说了，贝叶斯公式，却成为因果推断的基石，也是人类认识世界的起点。

事实上很多动物都有了初步的因果推断能力。

有些动物会使用简单的工具，譬如乌鸦会填石子去喝水。动物会使用工具，这表示这些动物都具备了一些因果推断能力。然而，并不是所有的动物在使用工具方面都表现出同样的能力。有些动物确实展示出了较强的因果推断能力，而另一些动物则可能在更简单的认知任务中表现出因果推断的迹象。

譬如乌鸦发现填进石子后瓶里的水面会上涨，这种是**直接观察得出的因果关系**。并不需要复杂的贝叶斯推断。

- 猴子是著名的工具使用者。它们可以使用物体作为工具来获取食物，如使用树枝、石块或其他物体敲打坚果。这表明猴子具备了一定的因果推断能力，能够理解使用工具可以改变环境并实现特定目标。
- 此外，鸟类也展示了一些因果推断的能力。例如，新几内亚的渡鸟会使用棍子或树枝作为工具，来获取食物或防御。乌鸦和鹦鹉等鸟类也展示了一定的工具使用能力。
- 然而，也有**许多动物在解决简单的认知任务时可能会展现出一定的因果推断能力，但并不一定能够使用工具**。例如，一些啮齿动物在追踪食物存放地点时可能会运用因果推断，但它们并不会使用工具。
- 总之，动物的因果推断能力是使用工具的前提。

贝叶斯推断则为大脑提供了复杂环境下的判断分析能力。某些研究表明，一些动物（如灵长类动物、鸟类和啮齿动物）可能具有类似贝叶斯推理的能力，能够**根据观察到的信息更新他们对事件的概率估计**。贝叶斯大脑提供了更强大的因果推断能力，能够应对复杂环境。

贝叶斯大脑可能是**人类思维快系统（直觉）**的重要基础（见《思考，快与慢》）。

- 有些研究学者认为贝叶斯大脑可能是人类思维快速系统（直觉）的重要基础之一。贝叶斯大脑的概念提出了人类在处理不确定性和推理时可能使用的概率推断的框架。
- 人类的思维和决策过程通常需要面对复杂的不确定性和不完整的信息，例如在做出决策、对事件进行分类或推断因果关系时。贝叶斯大脑的假设认为人类大脑可能使用类似于贝叶斯推断的机制来进行概率推断和更新，从而在面对不确定性时能够进行快速的、自动的推理。
- 这种概率推断的能力可能形成了人类思维快速系统（直觉）的重要基础。直觉是指在没有深思熟虑或明确计算的情况下，基于直觉和经验快速做出判断和决策的能力。贝叶斯推断的思维模式可能在人类大脑中形成了一种直觉式的推理方式，使得人们可以在短时间内快速地进行概率推断和决策。

因果推理是真正智能的算法基础！因果推理 + 知识 就构成了人类的智能，造就了灿烂的文化！现在 Chatgpt 等语言大模型已经解决了知识，AGI 只缺少因果推理了！

另外，因果推理和意识的关系非常密切！这个专题另外撰文。
