---
aliases: 5-关键点
tags: [待看]
date created: Wednesday, September 18th 2024, 11:43:32 am
date modified: Wednesday, September 18th 2024, 12:16:59 pm
---
# 什么是关键点
### 什么是关键点，怎么定义的？
关键点（Keypoints）在计算机视觉领域中是一个非常重要的概念，它们通常指的是图像或视频中可用于识别、描述或匹配场景中的对象或特征的独特或显著点。这些点具有稳定性、独特性和可重复性，是对象检测、跟踪、识别和匹配等任务的基础。关键点检测涉及同时检测人和定位他们的关键点，这些关键点可以是图像中的任何具有显著特征的点，如人脸的眼睛、鼻子、嘴巴等，也可以是其他物体的关键部位或特征点。
### oks 原理是什么？
OKS（Object Keypoint Similarity）是目标检测领域，特别是人体姿态估计中用于评估预测关键点与真实关键点之间相似度的一个指标。其原理基于关键点之间的空间距离和尺度信息，通过计算预测关键点与真实关键点之间的归一化距离，来评估预测的准确性。OKS 分数越高，表示预测的关键点与真实关键点越接近，预测的准确性也就越高。
### 具体又是怎么计算的？
OKS 的计算公式如下：
$$
OKS = \frac{\sum_{i} \exp\left[ -\frac{d_i^2}{2s^2k_i^2} \delta(v_i > 0) \right]}{\sum_{i} \delta(v_i > 0)}
$$
其中：
- $i$ 表示关键点的个数。
- $d_i$ 表示第 $i$ 个预测关键点与真实关键点之间的距离。
- $s$ 表示关键点尺度，通常与对象的大小相关，用于归一化距离。
- $k_i$ 表示第 $i$ 个关键点的主方向（在某些情况下可能不使用，视具体实现而定）。
- $\delta$ 表示狄拉克 $\delta$ 函数，当条件满足时（即 $v_i > 0$，表示关键点可见）为 1，否则为 0。
- $v_i$ 表示第 $i$ 个关键点是否可见，可见为 1，不可见或未标注为 0。
这个公式通过计算每个可见关键点的归一化距离，并加权求和（权重为 $\exp$ 函数的结果），最后除以可见关键点的总数，得到 OKS 分数。这个分数越高，表示预测的关键点位置越准确，与真实关键点的相似度越高。
总的来说，关键点是计算机视觉中用于描述和识别图像中对象或特征的重要工具，而 OKS 则是评估这些关键点预测准确性的有效方法。
# 关键点的主方向和尺度
### 关键点的主方向和尺度
**关键点的主方向**：
在图像处理中，尤其是在使用 SIFT（尺度不变特征变换）等算法时，关键点的主方向是一个非常重要的概念。主方向是指关键点（通常是图像中的显著点，如角点、边缘点等）周围像素梯度的主要方向。这个方向是通过计算关键点周围邻域内像素的 [[1.1.3-纹理相似度和形状相似度#纹理相似度 - 梯度方向直方图|梯度方向直方图]] 来确定的，直方图中幅值最高的方向即为关键点的主方向。主方向的确定使得关键点描述子具有旋转不变性，即无论图像如何旋转，只要关键点保持不变，其描述子也能保持不变。
**关键点的尺度**：
尺度是指关键点所在图像区域的尺寸大小。在 SIFT 等算法中，尺度是通过构建尺度空间金字塔来模拟的，即在多个不同的尺度上对图像进行平滑和重采样。关键点的尺度就是在这个尺度空间金字塔中，关键点所在层级的尺度参数。尺度的确定使得关键点描述子具有尺度不变性，即无论图像如何缩放，只要关键点及其周围的图像结构保持不变，其描述子也能保持不变。
### 狄拉克函数的定义
狄拉克函数（Dirac function），也称为狄拉克δ函数或冲激函数，是一个在数学和物理领域中广泛应用的函数。它的定义如下：
- 在除了零以外的所有点上，狄拉克函数的值都为零，即 $δ(t) = 0，当t ≠ 0$。
- 狄拉克函数在整个实数轴上的积分等于 1，即 $∫_{-∞}^{∞} δ(t) dt = 1$。
- 狄拉克函数在 t=0 处没有定义，但从广义函数的角度来看，可以认为它在该点处取得无穷大的值，并且这个无穷大的值与零宽度的乘积（即面积）为 1。
狄拉克函数主要用于描述某些瞬时事件或突变，如物理学中的点电荷、量子力学中的波函数等。在信号处理、系统响应等领域中，狄拉克函数也扮演着重要角色，如用于表示系统的冲激响应等。
综上所述，关键点的主方向和尺度是图像处理中用于描述关键点特性的重要参数，而狄拉克函数则是一个在数学和物理领域中广泛应用的特殊函数。
## 尺度怎么计算？
关键点的尺度是在计算机视觉和图像处理中，特别是在使用特征检测算法（如 SIFT、SURF 等）时，用于描述关键点所在图像区域尺寸大小的一个重要参数。尺度的计算通常与构建尺度空间金字塔的过程密切相关。以下是关键点尺度计算的一般步骤和原理：
### 一、构建尺度空间
1. **高斯滤波**：首先，对原图像进行高斯滤波处理。高斯滤波是一种线性平滑滤波，通过改变高斯函数的尺度参数（σ）来得到不同平滑程度的图像。这些图像按照尺度参数从小到大的顺序排列，构成了图像的尺度空间。
2. **尺度参数**：尺度参数σ决定了高斯滤波的平滑程度，也间接决定了关键点所在的尺度。σ越大，滤波后的图像越模糊，对应的尺度也越大；σ越小，滤波后的图像越接近原图像，对应的尺度也越小。
### 二、关键点检测
1. **极值检测**：在尺度空间中，通过比较每个像素点与其相邻像素点（包括同尺度和不同尺度的相邻点）的灰度值，找到局部极值点。这些极值点可能是图像中的显著特征点，如角点、边缘点等。
2. **尺度选择**：对于每个检测到的极值点，需要确定其所在的尺度。这通常是通过比较该点在不同尺度下的响应值（如 DOG 算子中的差值）来完成的。响应值最大的尺度被认为是该关键点的最优尺度。
#### DOG 算子
DOG 算子，全称为 Difference of Gaussians（高斯差分算子），在计算机视觉和图像处理中，特别是在特征检测算法（如 SIFT）中扮演着重要角色。DOG 算子的主要思想是利用两个不同尺度的高斯核与图像进行卷积，然后计算这两个卷积结果之间的差值。
##### DOG 算子的形式
DOG 算子可以形式化地表示为两个不同尺度的高斯滤波图像之间的差：
$$
\text{DOG}(x, y, \sigma_1, \sigma_2) = G(x, y, \sigma_1) - G(x, y, \sigma_2)
$$
其中，$G(x, y, \sigma)$ 表示使用标准差为 $\sigma$ 的高斯核对图像进行卷积的结果，即高斯滤波图像。这里，$x$ 和 $y$ 是图像中的像素坐标，$\sigma_1$ 和 $\sigma_2$ 是两个不同的高斯标准差，通常 $\sigma_2 > \sigma_1$。
##### DOG 算子的差值
DOG 算子的 " 差值 " 就是上述公式中两个高斯滤波图像 $G(x, y, \sigma_1)$ 和 $G(x, y, \sigma_2)$ 之间的差。这个差值图像突出了那些在不同尺度下显著变化的区域，即图像中的边缘、角点等特征。由于高斯滤波能够平滑图像并去除噪声，而差分运算则能够突出变化区域，因此 DOG 算子能够在保留图像重要特征的同时，减少噪声的干扰。
在实际应用中，为了检测图像中的关键点（如角点、斑点等），通常会构建一个尺度空间金字塔，该金字塔由多个不同尺度的高斯滤波图像组成。然后，在相邻的尺度层之间计算 DOG 算子，得到一系列 DOG 图像。接下来，在这些 DOG 图像中搜索局部极值点（==即比其周围 8 个邻域点以及上下两层中相邻的 18 个点都大或都小的点==），这些极值点就被认为是图像中的关键点。
综上所述，DOG 算子通过计算两个不同尺度高斯滤波图像之间的差值，来突出图像中的边缘、角点等特征，为后续的特征检测和匹配提供重要信息。
### 三、尺度计算的具体方法
1. **泰勒展开**：在一些算法中，为了更精确地确定关键点的位置和尺度，可能会使用泰勒展开对局部区域进行拟合。通过对 DOG 算子进行泰勒二次展开，并求解拟合曲面的极值点，可以得到更精确的关键点位置和尺度。
2. **尺度不变性**：关键点的尺度参数使得关键点描述子具有尺度不变性。即无论图像如何缩放，只要关键点及其周围的图像结构保持不变，其描述子也能保持不变。这是因为描述子是在关键点所在的尺度下计算得到的，因此具有对尺度变化的鲁棒性。
## 尺度空间金字塔 #待看
尺度空间金字塔的计算主要基于图像的多尺度表示，其核心思想是通过不同尺度的平滑处理来模拟图像在不同距离下的观察效果。这一过程通常涉及高斯滤波和图像的降采样（或称为下采样）。以下是尺度空间金字塔计算的具体步骤：
### 一、构建尺度空间
1. **高斯滤波**：首先，使用高斯函数对原图像进行滤波处理。高斯滤波是一种线性平滑滤波，能够有效地去除图像噪声，同时保留图像的边缘信息。通过改变高斯函数的尺度参数（σ），可以得到不同平滑程度的图像。
   高斯滤波的公式为：
   $$
   L(x, y, \sigma) = G(x, y, \sigma) \otimes I(x, y)
   $$
   其中，$L(x, y, \sigma)$ 表示尺度为$σ$的图像，$G(x, y, \sigma)$ 是二维高斯函数，$I(x, y)$ 是原图像，$\otimes$ 表示卷积运算。
2. **生成多尺度图像**：通过改变$σ$的值，对原图像进行多次高斯滤波，得到一系列不同尺度的图像。这些图像按照尺度从小到大的顺序排列，就构成了图像的尺度空间。
#### 


二维高斯函数（也称为二维高斯分布或高斯核）在图像处理、计算机视觉和统计学中非常常见。它用于描述二维空间中的点围绕某个中心点的分布，其中距离中心点越近的点，其值越高；距离中心点越远的点，其值越低。二维高斯函数的形式可以表示为：
$$
G(x, y, \sigma) = \frac{1}{2\pi\sigma^2} e^{-\frac{x^2 + y^2}{2\sigma^2}}
$$
其中：
- $G(x, y, \sigma)$ 是二维高斯函数在点 $(x, y)$ 处的值。
- $x$ 和 $y$ 是二维空间中的坐标。
- $\sigma$ 是标准差，它决定了高斯函数的宽度（或 " 分散程度 "）。$\sigma$ 越大，函数越宽，图像越模糊；$\sigma$ 越小，函数越窄，图像越接近原图。
- $e$ 是自然对数的底数，约等于 2.71828。
- $2\pi\sigma^2$ 是归一化因子，确保整个高斯函数下的面积（或积分）为 1，即该函数是一个概率密度函数。
二维高斯函数在图像处理中常用于高斯滤波，通过卷积操作来平滑图像，减少图像噪声。此外，它还在特征检测（如 SIFT、SURF 算法）中用于构建尺度空间金字塔，以检测图像中的关键点。
在实际应用中，二维高斯函数可以离散化，并应用于图像的每个像素及其邻域，以计算滤波后的像素值。这通常通过创建一个高斯核（或称为高斯滤波器）来实现，该核是一个二维数组，其元素由二维高斯函数在特定点上的值给出。然后，将该核与图像进行卷积操作，以得到滤波后的图像。
### 二、构建金字塔
1. **降采样**：在尺度空间中，为了进一步减少计算量并模拟图像在不同分辨率下的观察效果，通常会对尺度空间中的图像进行降采样处理。降采样操作通常包括去除图像的偶数行和列，或者通过其他插值方法减少图像的像素数。
   降采样后的图像大小通常为原图像的 1/4（在长宽方向上都减半）。
2. **迭代降采样**：对尺度空间中的每一层图像都进行降采样处理，直到达到所需的金字塔层数。这样，每一层图像都是对前一层图像进行高斯滤波和降采样后得到的。
   高斯金字塔的总组数 O 和每组层数 S 可以通过以下公式计算：
   $$
   O = \left\lfloor \log_2 \min(X, Y) - 2 \right\rfloor
   $$
   $$
   S = s + 3
   $$
   其中，(X,Y) 表示图像的长宽，s 是 SIFT 算法中的一个参数（通常取 3）。
