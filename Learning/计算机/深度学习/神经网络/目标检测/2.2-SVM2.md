## 升维运算
对于这些在低维度下无法方便分类的数据，我们可以：
1. 通过合适的维度转换函数，将低维数据进行升维：![[Pasted image 20240827202432.png]]
2. 在高维度下求解 SVM 模型+：![[Pasted image 20240827202500.png]]
有一种方法，能够避免将数据送入高维度进行计算，又能获得同样的分类效果：
![[Pasted image 20240827202655.png]]
# 推导
![[Pasted image 20240827203218.png]]
 ![[Pasted image 20240827203421.png]]
 说明 $W$ 和决策超平面是互相垂直的，同时还满足 $\vec{w}\cdot(\vec{x_m}-\vec{x_n})=2$
  ![[Pasted image 20240827204043.png]]
  ![[Pasted image 20240827204138.png]]
   ![[Pasted image 20240827204310.png]]
   这等同于求解在约束条件下, 向量 $w$ 长度的最小化问题
   ![[Pasted image 20240827204541.png]]
   ![[Pasted image 20240827204646.png]]
- ? 凸优化： [zhuanlan.zhihu.com/p/85408804](https://zhuanlan.zhihu.com/p/85408804)
假设 $\vec{v_{1}}=(x_{11},x_{12},x_{13},\cdots,x_{1n})$ 为正超平面上一点, $\vec{v_{2}}=(x_{21},x_{22},x_{23},\cdots,x_{2n})$ 为负超平面上一点，$\vec{W}=(w_{1},w_{2},w_{3} ,\cdots,w_{n})$
有
$$
\begin{aligned}
\vec{W}\cdot\vec{v_{1}}+b=1&\qquad \vec{W}\cdot\vec{v_{2}}+b=-1\\
\vec{W}\cdot(&\vec{v_{1}}-\vec{v_{2}})=2
\end{aligned}
$$
又 $\vec{W}\cdot(\vec{v_{p1}}-\vec{v_{p2}})=0$, ($p_{1},p_{2}$ 为决策超平面上任意两点)，得 $\vec{W}\perp\vec{v_{p}}$  
所以 $(\vec{v_{1}}-\vec{v_{2}})\cdot\frac{\vec{W}}{|\vec{W}|}=L$
所以 $(\vec{v_{1}}-\vec{v_{2}})\cdot\frac{\vec{W}}{|\vec{W}|}=2\cdot\frac{1}{|\vec{W}|}=L$
目的是使 $L$ 最大，即 $|\vec{W}|$ 最小
由于样本点都满足 $y_{i}*(\vec{W}\cdot\vec{v}_{i}+b)\ge1$
设第 $i$ 个样本点满足 $y_{i}*(\vec{W}\cdot\vec{v}_{i}+b)-1=p_{i}^{2}$
共有 $s$ 个样本点，则有 $s$ 个约束条件，列出拉格朗日方程：
$$
L(\vec{w},b,\lambda_{i},p_{i})=\frac{\|\vec{w}\|^{2}}{2}-\sum_{i=1}^{s}\lambda_{i}*( y_{i}*(\vec{w}\cdot\vec{x}_{i}+b)-1-p_{i}^{2})
$$
其中 $s$ 为样本数量
> [【数之道25】机器学习必经之路-SVM支持向量机的数学精华_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV13r4y1z7AG/?spm_id_from=333.788&vd_source=56499cc54ebd02db0ac739e485d74801)
![[Pasted image 20240828140457.png]]
$\lambda_i(y_i*(\vec{w}\cdot\vec{x}_i+b)-1)=0$ 说明两种情况：
1. 对应数据点不在正负超平面上，$\lambda=0$
2. 对应数据点在正负超平面上，$\lambda\ne0$
我们可以把拉格朗日乘子 $\lambda_i$ 看做违背约束条件的惩罚系数（❓）
当不满足约束条件时，括号内的值小于 0，（即 $y_{i}*(\vec{W}\cdot\vec{v}_{i}+b)<1$ ，$\vec{v_{i}}$ 在正负超平面之间）：![[Pasted image 20240830173759.png]]
此时如果 $\lambda_{i}<0$，则 $\lambda_{i}*( y_{i}*(\vec{w}\cdot\vec{x}_{i}+b)-1-p_{i}^{2})>0$ ，减去该项使得 $L(w,b,\lambda_{i},p_{i})$ 变得更小
![[Pasted image 20240830174742.png]]
![[Pasted image 20240830174759.png]]
+这是违反常理的
![[Pasted image 20240830174838.png]]
- 如果点不在正负超平面上，$\lambda_{i}=0$
- 如果点在正负超平面上，$\lambda_{i}\neq0$
- 如果点在正负超平面之间，即违反了决策，则 $\lambda_{i}\ge0$

## 可视化约束条件的影响
若只有一个约束条件
![[Pasted image 20240830233750.png]]
此时在切点处 $f(W)$ 的梯度向量指向其函数值增加最大的方向
![[Pasted image 20240830234030.png]]
![[Pasted image 20240830235208.png]] 由于 $\frac{\partial L}{\partial W}=0$, 所以