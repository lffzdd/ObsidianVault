函数执行的代码（即指令）存放在内存的**代码段**（Code Segment），也称为 **文本段**（Text Segment）。以下是具体解释：
---
### 1. **代码段（Text Segment）**
- **位置**：
    - 代码段通常是程序在内存中分配的只读区域，用于存储编译好的机器指令。
    - 它的位置在现代操作系统中由操作系统和内存管理器决定，通常位于进程地址空间的较低部分。
- **特点**：
    - **只读**：为了防止程序无意或恶意修改自身的代码，代码段通常被设置为只读。
    - **共享**：如果多个进程运行相同的程序，它们可以共享同一个代码段，减少内存开销。
- **内容**：
    - 函数的指令。
    - 静态库和动态库中被加载的指令。
---
### 2. **函数执行时的运行时上下文**
当函数被执行时，其指令仍在代码段，但程序运行的上下文涉及以下其他内存区域：
#### (1) **栈段（Stack Segment）**
- **用途**：存储函数调用过程中的局部变量、返回地址、参数等。
- **特点**：
    - 每次函数调用都会分配一个栈帧。
    - 栈是线程私有的。
#### (2) **堆段（Heap Segment）**
- **用途**：存储动态分配的数据（如通过 `malloc` 或 `new`）。
- **特点**：
    - 由程序动态申请和释放。
    - 堆空间是进程共享的。
#### (3) **数据段（Data Segment）**
- **用途**：存储程序中的全局变量和静态变量。
- **特点**：
    - 包括 **初始化数据段**（存储已初始化的全局和静态变量）和 **未初始化数据段（BSS）**（存储未初始化的全局和静态变量）。
#### (4) **寄存器**
- **用途**：存储临时数据和控制信息（如函数参数、返回值等）。
- **特点**：
    - CPU 使用寄存器（如 `EAX`, `RAX`, `ESP`）在函数执行过程中快速存取数据。
---
### 3. **现代系统中的代码段保护**
- 现代操作系统使用 **内存保护** 技术来防止非法操作。
    - **NX（No-eXecute）位**：标记某些内存区域（如栈和堆）为不可执行。
    - 代码段的页表权限设置为只读 + 可执行。
---
### 4. **示意图：进程地址空间**
以下是典型进程地址空间中各区域的布局：
```
+--------------------+  高地址
|       栈段         |  <--- 函数局部变量、返回地址等
+--------------------+
|       堆段         |  <--- 动态分配内存
+--------------------+
|   动态库 / 数据段   |  <--- 全局变量、静态变量
+--------------------+
|      代码段        |  <--- 函数指令、程序代码
+--------------------+
| 操作系统保留空间    |  <--- 不可访问
+--------------------+  低地址
```
---
### 5. **总结**
- 函数的机器指令存放在内存的 **代码段**（Text Segment）。
- 执行函数时，其他上下文（如栈段和寄存器）用于存储运行时数据和控制信息。