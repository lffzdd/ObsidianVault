在使用 GPT 分区表安装 Linux 和 Windows 11 双系统时，你可以按照以下步骤来划分磁盘。和 MBR 不同，GPT 支持更多的主分区，并且分区布局也有所不同。下面是一个典型的 GPT 分区设置过程：
### 1. **创建 GPT 分区表**
你已经完成了这一步：
```bash
parted /dev/nvme0n1 mklabel gpt
```
### 2. **创建分区**
在 GPT 分区表下，你可以直接创建主分区，不需要扩展和逻辑分区。通常我们需要以下几个分区：
- **EFI 分区**（用于引导）：一般建议至少 512MB。
- **Linux 根分区 `/`**：根据你的需求大小分配。
- **Linux 交换分区**：一般分配 1-2倍的内存大小。
- **Windows 系统分区**：根据 Windows 11 需求分配（至少 50GB，推荐更大）。
- **数据分区**（可选）：如果你想在 Linux 和 Windows 间共享数据，创建一个 NTFS 格式的分区。
#### 创建 EFI 分区
Windows 11 和 Linux 都需要一个 **EFI 系统分区**（ESP），所以必须先创建这个分区，通常大小为 512MB：
```bash
parted /dev/nvme0n1 mkpart ESP fat32 1MiB 513MiB
parted /dev/nvme0n1 set 1 esp on
```
- 这将创建一个从 1MiB 到 513MiB 的 **EFI 分区**，并将其标记为 `boot` 分区。
#### 创建 Linux 分区
- **Linux `/boot` 分区**：你可以单独为 `/boot` 分区创建空间，也可以把它合并到根分区中。如果需要单独分区，通常 1GB 左右就足够：
```bash
parted /dev/nvme0n1 mkpart primary ext4 513MiB 2GiB
```
- **Linux 根分区**：这是 Linux 系统的主要分区，大小根据你的需要设定。假设你需要 50GB：
```bash
parted /dev/nvme0n1 mkpart primary ext4 2GiB 52GiB
```
- **Linux 交换分区**：如果你需要交换分区，通常大小为内存的 1-2倍。假设你分配 8GB 交换分区：
```bash
parted /dev/nvme0n1 mkpart primary linux-swap 52GiB 60GiB
```
#### 创建 Windows 分区
- 为 Windows 11 分配一个足够大的主分区（至少 50GB）。假设你分配 100GB：
```bash
parted /dev/nvme0n1 mkpart primary ntfs 60GiB 160GiB
```
你可以根据需要增加这个分区的大小，确保有足够空间安装 Windows 11 及其应用。
#### 创建数据分区（可选）
如果你需要一个 Linux 和 Windows 都能访问的共享分区，创建一个 NTFS 或 FAT32 分区：
```bash
parted /dev/nvme0n1 mkpart primary ntfs 160GiB 100%
```
### 3. **查看分区布局**
创建完所有分区后，可以查看分区结果：
```bash
parted /dev/nvme0n1 print
```
### 4. **格式化分区**
- 格式化 EFI 分区：
```bash
mkfs.fat -F32 /dev/nvme0n1p1
```
- 格式化 Linux `/boot` 和根分区：
```bash
mkfs.ext4 /dev/nvme0n1p2
mkfs.ext4 /dev/nvme0n1p3
```
- 格式化交换分区：
```bash
mkswap /dev/nvme0n1p4
swapon /dev/nvme0n1p4
```
- 格式化 Windows 分区（Windows 安装程序会自动格式化这个分区为 NTFS，所以你可以跳过这步，或者预先格式化）：
```bash
mkfs.ntfs /dev/nvme0n1p5
```
### 5. **安装系统**
- **安装 Linux**：在安装 Linux 时，确保选择正确的根分区 `/` 和交换分区，并将 EFI 分区挂载为 `/boot/efi`。
- **安装 Windows 11**：在安装 Windows 11 时，选择创建的 Windows 分区进行安装。Windows 安装程序会自动检测并使用 EFI 分区。
### 6. **引导管理**
安装完成后，Linux 的引导加载程序（如 GRUB）会负责管理启动。在安装完 Linux 后，GRUB 应该能够检测到 Windows 系统，并将其加入到启动菜单中。如果 GRUB 没有自动检测到 Windows，你可以通过以下命令来更新 GRUB：
```bash
grub2-mkconfig -o /boot/grub2/grub.cfg
```
### 总结
你需要先创建 EFI 分区，然后为 Linux 和 Windows 各自分配分区，安装系统时要确保系统能够正确使用 EFI 分区来引导。希望这些步骤能帮助你顺利完成双系统的安装！