---
aliases: 8-vim编辑器
tags:
date created: 星期四, 十月 3日 2024, 9:17:41 晚上
date modified: 星期四, 十月 3日 2024, 9:21:14 晚上
---
# vim 编辑文件
有那么多的文书编辑器，为什么一定要学 vi？
- 所有的 Unix Like 系统都会内建 vi 文书编辑器，其他的文书编辑器则不一定会存在；
- ! 很多个别软件的编辑接口都会主动呼叫 vi (例如未来会谈到的 `crontab`, `visudo`, `edquota` 等指令)；
- vim 具有程序编辑的能力，可以主动的以字体颜色辨别语法的正确性，方便程序设计；
- 因为程序简单，编辑速度相当快速。
而 vim 可以视作 vi 的进阶版本，vim 可以用颜色或底线等方式来显示一些特殊的信息，vim 更多的是一个程序开发工具，里面加入了很多额外的功能，例如支持正规表示法的搜寻架构、多文件编辑、区块复制等等。
vi 有三种模式：![[Pasted image 20241003212256.png]]

## 转到指定位置

| 按键               | 作用                               |
| ---------------- | -------------------------------- |
| [Ctrl] + [f]<br> | 屏幕『向下』移动一页，相当于 [Page Down]按键(常用) |
| [Ctrl] + [b]     | 屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用) |
| 0 或功能键[Home]     | 这是数字『 0 』：移动到这一列的最前面字符处 (常用)     |
| $ 或功能键[End]      | 移动到这一列的最后面字符处(常用)                |
| G                | 移动到这个文件的最后一列(常用)                 |
| gg               | 移动到这个文件的第一列，相当于 1G(常用)           |
| n\<Enter\>       | n 为数字。光标向下移动 n 列(常用)             |
| n\<space\>       | 按下数字后再按空格键，光标会向右移动这一列的 n<br>个字符  |
| nG               | n 为数字。移动到这个文件的第 n 列              |
## 搜寻与取代

| 按键                    | 作用                                                                                                                                         |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| /word                 | 向光标之下寻找一个名称为 word 的字符串。 (常用)                                                                                                               |
| ?word                 | 向光标之上寻找一个字符串名称为 word 的字符串。                                                                                                                 |
| n                     | 转到下一个寻找到的字符                                                                                                                                |
| N                     | 转到上一个寻找到的字符                                                                                                                                |
|                       |                                                                                                                                            |
| :n1,n2s/word1/word2/g | n1 与 n2 为数字。在第 n1 与 n2 列之间寻找 word1 这个字符串，并将该字符串取代<br>为 word2 ！举例来说，在 100 到 200 列之间搜寻 vbird 并取代为 VBIRD 则：<br>『:100,200s/vbird/VBIRD/g』。(常用) |
| :1,$s/word1/word2/g   | 从第一列到最后一列寻找 word1 字符串，并将该字符串取代为 word2 ！(常用)                                                                                                |
| :1,$s/word1/word2/gc  | 从第一列到最后一列寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显<br>示提示字符给用户确认 (confirm) 是否需要取代！(常用)                                                          |
## 删除、复制与粘贴
| 按键         | 作用                                                                                                                                                                  |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| x, X       | 在一列字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字<br>符(相当于 [backspace] 亦即是退格键) (**常用**)                                                                                 |
| nx         | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。                                                                                                                       |
| dd         | 删除游标所在的那一整**列(常**用)                                                                                                                                                 |
| ndd        | n 为数字。删除光标所在的向下 n 列，例如 20dd 则是删除 20 **列 (常**用)                                                                                                                      |
| yy         | 复制游标所在的那一列(**常用**)                                                                                                                                                  |
| nyy        | n 为数字。复制光标所在的向下 n 列，例如 20yy 则是复制 20 列(**常用**)                                                                                                                       |
| p, P       | p 为将已复制的数据在光标下一列贴上，P 则为贴在游标上一列！ 举例来说，我目前<br>光标在第 20 列，且已经复制了 10 列数据。则按下 p 后， 那 10 列数据会贴在原本<br>的 20 列之后，亦即由 21 列开始贴。但如果是按下 P 呢？ 那么原本的第 20 列会被<br>推到变成 30 列。 (**常用**) |
| u          | 撤销前一个动作。(**常用**)                                                                                                                                                    |
| \[Ctrl\]+r | 撤销撤销。(**常用**)                                                                                                                                                       |
| .          | 重做上一个动作                                                                                                                                                             |
## 进入编辑模式
![[Pasted image 20241003222531.png]]
## 保存和退出
![[Pasted image 20241003223335.png]]
- & 特别注意，在 vi 中，『数字』是很有意义的！数字通常代表重复做几次的意思！也有可能是代表去到第几个什么什么的意思。举例来说，要删除 50 列，则是用 『50dd』 对吧！数字加在动作之前～那我要向下移动 20 列呢？那就是『20j』或者是『20↓』即可。
## 批量选择字符

| 按键       | 选择模式                |
| -------- | ------------------- |
| v        | 字符选择，会将光标经过的地方反白选择！ |
| V        | 列选择，会将光标经过的列反白选择！   |
| [Ctrl]+v | 区块选择，可以用长方形的方式选择资料  |
| y        | 将反白的地方复制起来          |
| d        | 将反白的地方删除掉           |
| p        | 将刚刚复制的区块，在游标所在处贴上！  |

## 多文件编辑
| 按键          | 功能                   |
| ----------- | -------------------- |
| :r filename | 将 file 内的所有内容复制到当前文件 |
| :n          | 编辑下一个文件              |
| :N          | 编辑上一个文件              |
| :files      | 列出当前打开的文件            |
## 多窗口功能

| 按键           | 功能                              |
| ------------ | ------------------------------- |
| :sp filename | 创建分区窗口打开文件，如果没 filename 就打开当前文件 |
| [ctrl]+w+↑/↓ | 移动到上/下一个窗口                      |
| [ctrl]+w+q   | 结束当前分区窗口                        |
## 挑字补全功能
| 按键                   | 功能                             |
| -------------------- | ------------------------------ |
| [ctrl]+x -> [ctrl]+n | 透过目前正在编辑的这个『文件的内容文字』作为关键词，予以补齐 |
| [ctrl]+x -> [ctrl]+f | 以当前目录内的『文件名』作为关键词，予以补齐         |
| [ctrl]+x -> [ctrl]+o | 以扩展名作为语法补充，以 vim 内建的关键词，予以补齐   |
文件拓展名要正确，vim 才会补齐关键词

## 常用指令示意图
![[Pasted image 20241007120650.png]]
# vim 救援回复
当我们在使用 vim 编辑时， vim 会在与被编辑的文件的目录下，再建立一个名为 .filename.swp 的文件。
若 vim 的工作被不正常的中断，导致暂存盘无法藉由正常流程来结束，暂存档就不会消失，当你再次打开原文件的时候，由于暂存盘存在的关系， vim 会主动的判断你的这个文件可能有些问题：![[Pasted image 20241004113114.png]]
- `[O]pen Read-Only`：由于 Linux 是多人多任务的环境，因此很可能有很多人同时在编辑同一个文件。此时可以选择开启成为只读(O)文件
- 在前一个 vim 的环境中，可能因为某些不知名原因导致 vim 中断 (crashed)，
	- 如果之前的 vim 处理动作尚未储存，此时要按下『R』，亦即使用 `(R)ecover` 的项目，此时 vim 会载入 .man_db.conf.swp 的内容，让你自己来决定要不要储存！这样就能够救回来你之前未储存的工作。不过那个 .man_db.conf.swp 并不会在你结束 vim 后自动删除，所以离开 vim 后还得要自行删除 .man_db.conf.swp 才能避免每次打开这个文件都会出现这样的警告！
	- 如果确定这个暂存盘没有用，可以直接按下『D』删除掉这个暂存盘，亦即 `(D)elete it` 。此时 vim 会载入 man_db.conf ，并且将旧的 .man_db.conf.swp 删除后，建立这次会使用的新的 .man_db.conf.swp 。
	- `(E)dit anyway`：打开你要编辑的那个文件， 并不会载入暂存盘的内容。
	- `(Q)uit`：按下 q 就离开 vim ，不会进行任何动作回到命令提示字符。
	- `(A)bort`：忽略这个编辑行为，感觉上与 quit 非常类似！ 也会送你回到命令提示字符就是啰！	
# vim 环境设定与记录
vim 会主动的将你曾经做过的行为记录下来，记录动作的文件是： ~/.viminfo 
每个 distributions 对 vim 的预设环境都不太相同，举例来说，某些版本在搜寻到关键词时并不会高亮度反白，有些版本则会主动的帮你进行缩排的行为。但这些其实都可以自行设定的，那就是 vim 的环境设定
vim 的环境设定参数有很多，如果你想要知道目前的设定值，可以在一般指令模式时输入『 `: set all` 』 来查阅
![[Pasted image 20241007115513.png]]
`:set` 只会在当次生效，下次 vim 打开就恢复默认设定了，可以通过配置文件来永久生效，整体 vim 的设定值一般是放置在 /etc/vimrc 这个文件，不过，不建议修改！可以修改 ~/.vimrc 这个文件 (预设不存在，需自行手动建立！)
![[Pasted image 20241007120219.png]]
在这个文件中，使用『 `set hlsearch` 』或『 `:set hlsearch` 』，亦即最前面有没有冒号『 : 』效果都是一样的！ 至于双引号则是批注符号！